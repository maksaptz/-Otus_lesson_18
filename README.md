# Vagrant-стенд c сетевой лабораторией

Описание домашнего задания:

## Цель и задачи домашнего задания:
Настроить хосты в соответсвии со схемой(см. network_map.png). 
Задание состоит из 2-х частей: теоретической и практической.


В теоретической части требуется: 
1) Найти свободные подсети;
2) Посчитать количество узлов в каждой подсети, включая свободные;
3) казать Broadcast-адрес для каждой подсети;
4) Проверить, нет ли ошибок при разбиении.


В практической части требуется: 
1) Соединить офисы в сеть согласно логической схеме и настроить роутинг;
2) Интернет-трафик со всех серверов должен ходить через inetRouter;
3) Все сервера должны видеть друг друга (должен проходить ping);
4) У всех новых серверов отключить дефолт на NAT (eth0), который vagrant поднимает для связи.


### Описание домашнего задания
#### Теоретическая часть:


| Имя сети          |      Сеть      | Кол-во хостов | Широковещательный адрес |
|    :---:          |     :---:      |     :---:     |     :---:               |
| Directors         | 192.168.0.0/28 | 14            | 192.168.0.15            |
|Office hardware    |192.168.0.32/28 | 14            | 192.168.0.47            |
| Wifi(mgt network) | 192.168.0.64/26| 62            |192.168.0.127            |
| Dev               | 192.168.2.0/26 | 62            | 192.168.2.63            |
|Test               | 192.168.2.64/26| 62            | 192.168.2.127           |
| Managers          |192.168.2.128/26| 62            | 192.168.2.191           |
| Office hardware   |192.168.2.192/26| 62            | 192.168.2.255           |
| Dev               | 192.168.1.0/25 |126            | 192.168.1.127           |
| Test              |192.168.1.128/26|62             | 192.168.1.191           |
| Office            |192.168.1.192/26|62             | 192.168.1.255           |
|Inet — central     |192.168.255.0/30| 2            | 192.168.255.3           |
| Свободная         | 192.168.0.16/28| 14            | 192.168.0.31            |
| Свободная         | 192.168.0.48/28| 14            | 192.168.0.63            |
| Свободная         |192.168.0.128/25| 126           | 192.168.0.255           |
| Свободная         |192.168.255.64/26| 62           | 192.168.255.127         |
| Свободная         |192.168.255.32/27| 30           | 192.168.255.63          |
| Свободная         | 192.168.255.16/28| 14          | 192.168.255.31          |
| Свободная         | 192.168.255.8/29 | 6           | 192.168.255.15          |
| Свободная         | 192.168.255.4/30 | 2           | 192.168.255.7           |


#### Практическая часть:


Vagrntfile разворачивает следующие хосты:
1) inetRouter - маршрутизатор через который все хосты выходят в сеть.


Настройки:
- форвард пакетов ядро;
- сетевой экран и маскарад;
- маршруты в низлежащие сети.
2) centralRouter- центральный хост который соединяет все сети.


Настройки:
- форвард пакетов ядро;
- маршруты в низлежащие сети.
3) centralServer - сервер в сети centralRouter.


Настройки:
- маршрут по умолчанию.
4) office1Router - хост за которым находиться сеть 1 офиса.


Настройки:
- форвард пакетов ядро;
- маршрут в смежные сети.
5) office1Server - сервер в сети 1 офиса.


Настройки:
- маршрут по умолчанию.
6) office2Router - хост за которым находиться сеть 2 офиса.


  Настройки:
- форвард пакетов ядро;
- маршрут в смежные сети.
7) office2Server - сервер в сети 2 офиса.


Настройки:
- маршрут по умолчанию.

#### Ход выполнения
Для выполнения домашнего задания был настроен Vagrantfile который разворачивает хосты с готовыми сетевыми интерфейсами и запускает ansible для настройки машин.


Ansible использует 4 роли:
1) coreForward - включает на маршрутизаторах форвардинг пакетов в ядре;
2) nat - конфигурирует на inetRouter файрволл и маскарад;
3) routes - настраивает маршруты на всех хостах а также устанавливает traceroute на Ubuntu os
4) reboot - перезагружает хосты
